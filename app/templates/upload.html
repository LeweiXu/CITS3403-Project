{% extends "base.html" %}

{% block title %}MediaTracker - Upload{% endblock %}

{% block content %}
<div class="upload-container">
    <div class="'upload-card">
        <h1 class="upload-title">Upload CSV File &amp Media Details</h1>
        <!-- CSV Upload Section -->
        <section class="form-section">
            <h2>Upload CSV File</h2>
            <form action="/upload" method="post" enctype="multipart/form-data" id = "csv-upload-form">
                <div class="form-group full"></div>
                    <!-- CSV Drag and Drop Zone -->
                    <div id="drop-zone">
                        <p> Drag &amp; drop your csv here <br>- or - <br>
                            <button type="button" id="choose-file-btn" class="btn btn-outline-primary btn-sm">
                                Browse files
                            </button>
                        </p>
                        <!-- hide the native picker -->
                        <input type="file" id="csvFile" name="csvFile" accept=".csv" required hidden >
                    </div>
                </div>
                <div class="form-actions full">
                    <button type="submit" class="btn btn-primary btn-sm">Upload</button>
                </div>
            </form>
        </section>

        <!-- Media Details Form -->
        <section class = "form-section">
            <h2>Media Details</h2>
            <form action="/submit" method="post" class="upload-form">
                <div class="form-group">
                    <label for="mediaType">Media Type:</label>
                    <input type="text" id="mediaType" name="mediaType" required>
                </div>
                <div class="form-group">
                    <label for="mediaName">Media Name:</label>
                    <input type="text" id="mediaName" name="mediaName" required>
                </div>
                <div class="form-group">
                    <label for="duration">Duration:</label>
                    <input type="text" id="duration" name="duration" required>
                </div>
                <div class="form-group">
                    <label for="date">Date:</label>
                    <input type="date" id="date" name="date" required>
                </div>
                <div class="form-actions full">
                    <button type="submit" class="btn btn-primary btn-sm">Submit</button>
                </div>
            </form>
        </section>
     </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  const dropZone    = document.getElementById('drop-zone');
  const fileInput   = document.getElementById('csvFile');
  const browseBtn   = document.getElementById('choose-file-btn');

  // “Browse files” button opens native picker
  browseBtn.addEventListener('click', () => fileInput.click());

  // Highlight when dragging files over
  ['dragenter', 'dragover'].forEach(evt =>
    dropZone.addEventListener(evt, e => {
      e.preventDefault();
      dropZone.classList.add('hover');
    })
  );
  // Remove highlight on leave or drop
  ['dragleave', 'drop'].forEach(evt =>
    dropZone.addEventListener(evt, e => {
      e.preventDefault();
      dropZone.classList.remove('hover');
    })
  );

  // On file drop, assign to hidden input + show filename
  dropZone.addEventListener('drop', e => {
    const files = e.dataTransfer.files;
    if (!files.length) return;
    fileInput.files = files;
    dropZone.querySelector('p').textContent = files[0].name;
  });
</script>
{% endblock %}